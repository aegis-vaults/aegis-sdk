{
  "address": "ET9WDoFE2bf4bSmciLL7q7sKdeSYeNkWbNMHbAMBu2ZJ",
  "metadata": {
    "name": "aegis_core",
    "version": "0.1.0",
    "spec": "0.1.0",
    "description": "Aegis Protocol - On-chain operating system for AI finance on Solana"
  },
  "docs": [
    "Aegis Protocol - On-chain operating system for AI finance on Solana",
    "",
    "This program provides secure vault management with policy-based transaction guards,",
    "whitelist controls, daily spending limits, and manual override capabilities."
  ],
  "instructions": [
    {
      "name": "add_to_whitelist",
      "docs": [
        "Add an address to the vault's whitelist",
        "",
        "# Arguments",
        "* `vault_nonce` - The nonce used to derive the vault PDA",
        "* `address` - Address to add to the whitelist"
      ],
      "discriminator": [
        157,
        211,
        52,
        54,
        144,
        81,
        5,
        55
      ],
      "accounts": [
        {
          "name": "vault",
          "writable": true,
          "pda": {
            "seeds": [
              {
                "kind": "const",
                "value": [
                  118,
                  97,
                  117,
                  108,
                  116
                ]
              },
              {
                "kind": "account",
                "path": "authority"
              },
              {
                "kind": "arg",
                "path": "vault_nonce"
              }
            ]
          }
        },
        {
          "name": "authority",
          "signer": true,
          "relations": [
            "vault"
          ]
        }
      ],
      "args": [
        {
          "name": "vault_nonce",
          "type": "u64"
        },
        {
          "name": "address",
          "type": "pubkey"
        }
      ]
    },
    {
      "name": "approve_override",
      "docs": [
        "Approve a pending override request",
        "",
        "# Arguments",
        "* `vault_nonce` - The nonce used to derive the vault PDA",
        "",
        "Allows vault authority to manually approve a blocked transaction."
      ],
      "discriminator": [
        41,
        2,
        181,
        184,
        119,
        133,
        62,
        52
      ],
      "accounts": [
        {
          "name": "vault",
          "pda": {
            "seeds": [
              {
                "kind": "const",
                "value": [
                  118,
                  97,
                  117,
                  108,
                  116
                ]
              },
              {
                "kind": "account",
                "path": "authority"
              },
              {
                "kind": "arg",
                "path": "vault_nonce"
              }
            ]
          },
          "relations": [
            "pending_override"
          ]
        },
        {
          "name": "authority",
          "signer": true,
          "relations": [
            "vault"
          ]
        },
        {
          "name": "pending_override",
          "writable": true,
          "pda": {
            "seeds": [
              {
                "kind": "const",
                "value": [
                  111,
                  118,
                  101,
                  114,
                  114,
                  105,
                  100,
                  101
                ]
              },
              {
                "kind": "account",
                "path": "vault"
              },
              {
                "kind": "account",
                "path": "pending_override.nonce",
                "account": "PendingOverride"
              }
            ]
          }
        }
      ],
      "args": [
        {
          "name": "vault_nonce",
          "type": "u64"
        }
      ]
    },
    {
      "name": "create_override",
      "docs": [
        "Create a pending override request for a blocked transaction",
        "",
        "# Arguments",
        "* `vault_nonce` - The nonce used to derive the vault PDA",
        "* `destination` - The destination address for the blocked transaction",
        "* `amount` - Amount of the blocked transaction (in lamports)",
        "* `reason` - Reason why the transaction was blocked"
      ],
      "discriminator": [
        155,
        251,
        76,
        3,
        17,
        208,
        181,
        67
      ],
      "accounts": [
        {
          "name": "vault",
          "writable": true,
          "pda": {
            "seeds": [
              {
                "kind": "const",
                "value": [
                  118,
                  97,
                  117,
                  108,
                  116
                ]
              },
              {
                "kind": "account",
                "path": "authority"
              },
              {
                "kind": "arg",
                "path": "vault_nonce"
              }
            ]
          }
        },
        {
          "name": "authority",
          "writable": true,
          "signer": true,
          "relations": [
            "vault"
          ]
        },
        {
          "name": "pending_override",
          "writable": true,
          "pda": {
            "seeds": [
              {
                "kind": "const",
                "value": [
                  111,
                  118,
                  101,
                  114,
                  114,
                  105,
                  100,
                  101
                ]
              },
              {
                "kind": "account",
                "path": "vault"
              },
              {
                "kind": "account",
                "path": "vault.override_nonce",
                "account": "VaultConfig"
              }
            ]
          }
        },
        {
          "name": "system_program",
          "address": "11111111111111111111111111111111"
        }
      ],
      "args": [
        {
          "name": "vault_nonce",
          "type": "u64"
        },
        {
          "name": "destination",
          "type": "pubkey"
        },
        {
          "name": "amount",
          "type": "u64"
        },
        {
          "name": "reason",
          "type": {
            "defined": {
              "name": "BlockReason"
            }
          }
        }
      ]
    },
    {
      "name": "execute_agent",
      "docs": [
        "Execute an agent-signed transaction with policy validation",
        "",
        "Allows the authorized AI agent to execute transactions autonomously within",
        "the vault's policy constraints. The agent_signer must match vault.agent_signer.",
        "",
        "Policy checks enforced:",
        "- Vault not paused",
        "- Destination is whitelisted",
        "- Amount within daily limit",
        "",
        "# Arguments",
        "* `vault_nonce` - The nonce used to derive the vault PDA",
        "* `amount` - Amount to transfer (in lamports)"
      ],
      "discriminator": [
        17,
        189,
        103,
        244,
        206,
        233,
        43,
        155
      ],
      "accounts": [
        {
          "name": "vault",
          "docs": [
            "Vault configuration account",
            "Note: We use the vault's stored authority for seed derivation"
          ],
          "writable": true,
          "pda": {
            "seeds": [
              {
                "kind": "const",
                "value": [
                  118,
                  97,
                  117,
                  108,
                  116
                ]
              },
              {
                "kind": "account",
                "path": "vault.authority",
                "account": "VaultConfig"
              },
              {
                "kind": "arg",
                "path": "vault_nonce"
              }
            ]
          }
        },
        {
          "name": "agent_signer",
          "docs": [
            "The AI agent signer - must match vault.agent_signer"
          ],
          "signer": true
        },
        {
          "name": "vault_authority",
          "docs": [
            "Vault authority PDA that holds the actual SOL/USDC funds",
            "Seeds: [\"vault_authority\", vault.key()]",
            "This PDA can sign for transfers since we have the bump seed"
          ],
          "writable": true,
          "pda": {
            "seeds": [
              {
                "kind": "const",
                "value": [
                  118,
                  97,
                  117,
                  108,
                  116,
                  95,
                  97,
                  117,
                  116,
                  104,
                  111,
                  114,
                  105,
                  116,
                  121
                ]
              },
              {
                "kind": "account",
                "path": "vault"
              }
            ]
          }
        },
        {
          "name": "destination",
          "docs": [
            "Destination account to receive funds"
          ],
          "writable": true
        },
        {
          "name": "fee_treasury",
          "docs": [
            "Fee treasury account to collect protocol fees"
          ],
          "writable": true,
          "pda": {
            "seeds": [
              {
                "kind": "const",
                "value": [
                  116,
                  114,
                  101,
                  97,
                  115,
                  117,
                  114,
                  121
                ]
              }
            ]
          }
        },
        {
          "name": "system_program",
          "address": "11111111111111111111111111111111"
        }
      ],
      "args": [
        {
          "name": "vault_nonce",
          "type": "u64"
        },
        {
          "name": "amount",
          "type": "u64"
        }
      ]
    },
    {
      "name": "execute_approved_override",
      "docs": [
        "Execute a previously approved override transaction",
        "",
        "Executes a transaction that was blocked by policy but manually approved.",
        "Does not count against daily limits. Still collects protocol fees.",
        "",
        "# Arguments",
        "* `vault_nonce` - The nonce used to derive the vault PDA"
      ],
      "discriminator": [
        252,
        245,
        149,
        133,
        190,
        208,
        219,
        207
      ],
      "accounts": [
        {
          "name": "vault",
          "docs": [
            "Vault account"
          ],
          "writable": true,
          "pda": {
            "seeds": [
              {
                "kind": "const",
                "value": [
                  118,
                  97,
                  117,
                  108,
                  116
                ]
              },
              {
                "kind": "account",
                "path": "authority"
              },
              {
                "kind": "arg",
                "path": "vault_nonce"
              }
            ]
          },
          "relations": [
            "pending_override"
          ]
        },
        {
          "name": "pending_override",
          "docs": [
            "Pending override account - must be approved and not expired"
          ],
          "writable": true,
          "pda": {
            "seeds": [
              {
                "kind": "const",
                "value": [
                  111,
                  118,
                  101,
                  114,
                  114,
                  105,
                  100,
                  101
                ]
              },
              {
                "kind": "account",
                "path": "vault"
              },
              {
                "kind": "account",
                "path": "pending_override.nonce",
                "account": "PendingOverride"
              }
            ]
          }
        },
        {
          "name": "authority",
          "docs": [
            "Vault authority"
          ],
          "signer": true,
          "relations": [
            "vault"
          ]
        },
        {
          "name": "vault_authority",
          "docs": [
            "Vault authority PDA that holds the actual SOL/USDC funds",
            "Seeds: [\"vault_authority\", vault.key()]",
            "This PDA can sign for transfers since we have the bump seed"
          ],
          "writable": true,
          "pda": {
            "seeds": [
              {
                "kind": "const",
                "value": [
                  118,
                  97,
                  117,
                  108,
                  116,
                  95,
                  97,
                  117,
                  116,
                  104,
                  111,
                  114,
                  105,
                  116,
                  121
                ]
              },
              {
                "kind": "account",
                "path": "vault"
              }
            ]
          }
        },
        {
          "name": "destination",
          "docs": [
            "Destination account to receive funds (must match override.destination)"
          ],
          "writable": true
        },
        {
          "name": "fee_treasury",
          "docs": [
            "Fee treasury account to collect protocol fees"
          ],
          "writable": true,
          "pda": {
            "seeds": [
              {
                "kind": "const",
                "value": [
                  116,
                  114,
                  101,
                  97,
                  115,
                  117,
                  114,
                  121
                ]
              }
            ]
          }
        },
        {
          "name": "system_program",
          "address": "11111111111111111111111111111111"
        }
      ],
      "args": [
        {
          "name": "vault_nonce",
          "type": "u64"
        }
      ]
    },
    {
      "name": "execute_guarded",
      "docs": [
        "Execute a guarded transaction with policy validation (owner-signed)",
        "",
        "Validates transaction against vault policies (whitelist, daily limits).",
        "Requires the vault OWNER to sign. For agent-signed transactions, use execute_agent.",
        "",
        "# Arguments",
        "* `vault_nonce` - The nonce used to derive the vault PDA",
        "* `amount` - Amount to transfer (in lamports)"
      ],
      "discriminator": [
        158,
        204,
        46,
        60,
        195,
        151,
        172,
        90
      ],
      "accounts": [
        {
          "name": "vault",
          "writable": true,
          "pda": {
            "seeds": [
              {
                "kind": "const",
                "value": [
                  118,
                  97,
                  117,
                  108,
                  116
                ]
              },
              {
                "kind": "account",
                "path": "authority"
              },
              {
                "kind": "arg",
                "path": "vault_nonce"
              }
            ]
          }
        },
        {
          "name": "authority",
          "signer": true,
          "relations": [
            "vault"
          ]
        },
        {
          "name": "vault_authority",
          "docs": [
            "Vault authority PDA that holds the actual SOL/USDC funds",
            "Seeds: [\"vault_authority\", vault.key()]",
            "This PDA can sign for transfers since we have the bump seed"
          ],
          "writable": true,
          "pda": {
            "seeds": [
              {
                "kind": "const",
                "value": [
                  118,
                  97,
                  117,
                  108,
                  116,
                  95,
                  97,
                  117,
                  116,
                  104,
                  111,
                  114,
                  105,
                  116,
                  121
                ]
              },
              {
                "kind": "account",
                "path": "vault"
              }
            ]
          }
        },
        {
          "name": "destination",
          "docs": [
            "Destination account to receive funds"
          ],
          "writable": true
        },
        {
          "name": "fee_treasury",
          "docs": [
            "Fee treasury account to collect protocol fees"
          ],
          "writable": true,
          "pda": {
            "seeds": [
              {
                "kind": "const",
                "value": [
                  116,
                  114,
                  101,
                  97,
                  115,
                  117,
                  114,
                  121
                ]
              }
            ]
          }
        },
        {
          "name": "system_program",
          "address": "11111111111111111111111111111111"
        }
      ],
      "args": [
        {
          "name": "vault_nonce",
          "type": "u64"
        },
        {
          "name": "amount",
          "type": "u64"
        }
      ]
    },
    {
      "name": "initialize_treasury",
      "docs": [
        "Initialize the singleton fee treasury that collects protocol fees",
        "",
        "Creates the treasury PDA that will collect fees from all vault transactions.",
        "Can only be called once to initialize the treasury."
      ],
      "discriminator": [
        124,
        186,
        211,
        195,
        85,
        165,
        129,
        166
      ],
      "accounts": [
        {
          "name": "fee_treasury",
          "docs": [
            "Fee treasury account - singleton PDA"
          ],
          "writable": true,
          "pda": {
            "seeds": [
              {
                "kind": "const",
                "value": [
                  116,
                  114,
                  101,
                  97,
                  115,
                  117,
                  114,
                  121
                ]
              }
            ]
          }
        },
        {
          "name": "authority",
          "docs": [
            "Authority that will control the treasury (protocol owner)",
            "This account pays for the treasury creation"
          ],
          "writable": true,
          "signer": true
        },
        {
          "name": "system_program",
          "address": "11111111111111111111111111111111"
        }
      ],
      "args": []
    },
    {
      "name": "initialize_vault",
      "docs": [
        "Initialize a new vault configuration",
        "",
        "Creates a PDA-based vault config with spending limits and whitelist controls.",
        "Users can create unlimited vaults by using different nonce values.",
        "",
        "# Arguments",
        "* `nonce` - Unique identifier for this vault (allows multiple vaults per user)",
        "* `agent_signer` - The AI agent public key authorized to propose transactions",
        "* `daily_limit` - Maximum amount (in lamports) that can be spent per day",
        "* `name` - Human-readable name for the vault (max 50 chars)"
      ],
      "discriminator": [
        48,
        191,
        163,
        44,
        71,
        129,
        63,
        164
      ],
      "accounts": [
        {
          "name": "vault",
          "writable": true,
          "pda": {
            "seeds": [
              {
                "kind": "const",
                "value": [
                  118,
                  97,
                  117,
                  108,
                  116
                ]
              },
              {
                "kind": "account",
                "path": "authority"
              },
              {
                "kind": "arg",
                "path": "nonce"
              }
            ]
          }
        },
        {
          "name": "vault_authority",
          "docs": [
            "Vault authority PDA that holds the actual SOL/USDC funds",
            "Seeds: [\"vault_authority\", vault.key()]",
            "This is an empty SystemAccount that can receive and hold SOL"
          ],
          "pda": {
            "seeds": [
              {
                "kind": "const",
                "value": [
                  118,
                  97,
                  117,
                  108,
                  116,
                  95,
                  97,
                  117,
                  116,
                  104,
                  111,
                  114,
                  105,
                  116,
                  121
                ]
              },
              {
                "kind": "account",
                "path": "vault"
              }
            ]
          }
        },
        {
          "name": "authority",
          "writable": true,
          "signer": true
        },
        {
          "name": "system_program",
          "address": "11111111111111111111111111111111"
        }
      ],
      "args": [
        {
          "name": "nonce",
          "type": "u64"
        },
        {
          "name": "agent_signer",
          "type": "pubkey"
        },
        {
          "name": "daily_limit",
          "type": "u64"
        },
        {
          "name": "name",
          "type": "string"
        }
      ]
    },
    {
      "name": "pause_vault",
      "docs": [
        "Pause a vault to block all transactions",
        "",
        "Emergency function to immediately halt all vault operations.",
        "",
        "# Arguments",
        "* `vault_nonce` - The nonce used to derive the vault PDA"
      ],
      "discriminator": [
        250,
        6,
        228,
        57,
        6,
        104,
        19,
        210
      ],
      "accounts": [
        {
          "name": "vault",
          "docs": [
            "Vault to pause"
          ],
          "writable": true,
          "pda": {
            "seeds": [
              {
                "kind": "const",
                "value": [
                  118,
                  97,
                  117,
                  108,
                  116
                ]
              },
              {
                "kind": "account",
                "path": "authority"
              },
              {
                "kind": "arg",
                "path": "vault_nonce"
              }
            ]
          }
        },
        {
          "name": "authority",
          "docs": [
            "Vault authority - must match vault.authority"
          ],
          "signer": true,
          "relations": [
            "vault"
          ]
        }
      ],
      "args": [
        {
          "name": "vault_nonce",
          "type": "u64"
        }
      ]
    },
    {
      "name": "remove_from_whitelist",
      "docs": [
        "Remove an address from the vault's whitelist",
        "",
        "# Arguments",
        "* `vault_nonce` - The nonce used to derive the vault PDA",
        "* `address` - Address to remove from the whitelist"
      ],
      "discriminator": [
        7,
        144,
        216,
        239,
        243,
        236,
        193,
        235
      ],
      "accounts": [
        {
          "name": "vault",
          "writable": true,
          "pda": {
            "seeds": [
              {
                "kind": "const",
                "value": [
                  118,
                  97,
                  117,
                  108,
                  116
                ]
              },
              {
                "kind": "account",
                "path": "authority"
              },
              {
                "kind": "arg",
                "path": "vault_nonce"
              }
            ]
          }
        },
        {
          "name": "authority",
          "signer": true,
          "relations": [
            "vault"
          ]
        }
      ],
      "args": [
        {
          "name": "vault_nonce",
          "type": "u64"
        },
        {
          "name": "address",
          "type": "pubkey"
        }
      ]
    },
    {
      "name": "resume_vault",
      "docs": [
        "Resume a paused vault",
        "",
        "Re-enables transaction execution for a paused vault.",
        "",
        "# Arguments",
        "* `vault_nonce` - The nonce used to derive the vault PDA"
      ],
      "discriminator": [
        68,
        98,
        85,
        13,
        31,
        76,
        166,
        50
      ],
      "accounts": [
        {
          "name": "vault",
          "docs": [
            "Vault to resume"
          ],
          "writable": true,
          "pda": {
            "seeds": [
              {
                "kind": "const",
                "value": [
                  118,
                  97,
                  117,
                  108,
                  116
                ]
              },
              {
                "kind": "account",
                "path": "authority"
              },
              {
                "kind": "arg",
                "path": "vault_nonce"
              }
            ]
          }
        },
        {
          "name": "authority",
          "docs": [
            "Vault authority - must match vault.authority"
          ],
          "signer": true,
          "relations": [
            "vault"
          ]
        }
      ],
      "args": [
        {
          "name": "vault_nonce",
          "type": "u64"
        }
      ]
    },
    {
      "name": "update_agent_signer",
      "docs": [
        "Update the AI agent signer key",
        "",
        "Allows vault authority to rotate the agent's signing key for security.",
        "",
        "# Arguments",
        "* `vault_nonce` - The nonce used to derive the vault PDA",
        "* `new_agent_signer` - New public key for the AI agent"
      ],
      "discriminator": [
        46,
        230,
        68,
        81,
        4,
        213,
        33,
        21
      ],
      "accounts": [
        {
          "name": "vault",
          "docs": [
            "Vault to update"
          ],
          "writable": true,
          "pda": {
            "seeds": [
              {
                "kind": "const",
                "value": [
                  118,
                  97,
                  117,
                  108,
                  116
                ]
              },
              {
                "kind": "account",
                "path": "authority"
              },
              {
                "kind": "arg",
                "path": "vault_nonce"
              }
            ]
          }
        },
        {
          "name": "authority",
          "docs": [
            "Vault authority - must match vault.authority"
          ],
          "signer": true,
          "relations": [
            "vault"
          ]
        }
      ],
      "args": [
        {
          "name": "vault_nonce",
          "type": "u64"
        },
        {
          "name": "new_agent_signer",
          "type": "pubkey"
        }
      ]
    },
    {
      "name": "update_daily_limit",
      "docs": [
        "Update vault daily spending limit",
        "",
        "# Arguments",
        "* `vault_nonce` - The nonce used to derive the vault PDA",
        "* `new_daily_limit` - New maximum amount (in lamports) that can be spent per day"
      ],
      "discriminator": [
        100,
        231,
        226,
        195,
        132,
        221,
        134,
        71
      ],
      "accounts": [
        {
          "name": "vault",
          "writable": true,
          "pda": {
            "seeds": [
              {
                "kind": "const",
                "value": [
                  118,
                  97,
                  117,
                  108,
                  116
                ]
              },
              {
                "kind": "account",
                "path": "authority"
              },
              {
                "kind": "arg",
                "path": "vault_nonce"
              }
            ]
          }
        },
        {
          "name": "authority",
          "signer": true,
          "relations": [
            "vault"
          ]
        }
      ],
      "args": [
        {
          "name": "vault_nonce",
          "type": "u64"
        },
        {
          "name": "new_daily_limit",
          "type": "u64"
        }
      ]
    },
    {
      "name": "withdraw_fees",
      "docs": [
        "Withdraw collected fees from the treasury",
        "",
        "Allows the protocol authority to withdraw accumulated fees.",
        "Use u64::MAX for amount to withdraw all available fees.",
        "",
        "# Arguments",
        "* `amount` - Amount to withdraw in lamports (u64::MAX = withdraw all)"
      ],
      "discriminator": [
        198,
        212,
        171,
        109,
        144,
        215,
        174,
        89
      ],
      "accounts": [
        {
          "name": "fee_treasury",
          "docs": [
            "Fee treasury account - must match authority"
          ],
          "writable": true,
          "pda": {
            "seeds": [
              {
                "kind": "const",
                "value": [
                  116,
                  114,
                  101,
                  97,
                  115,
                  117,
                  114,
                  121
                ]
              }
            ]
          }
        },
        {
          "name": "authority",
          "docs": [
            "Treasury authority (must match fee_treasury.authority)"
          ],
          "signer": true
        },
        {
          "name": "recipient",
          "docs": [
            "Recipient account to receive the withdrawn fees"
          ],
          "writable": true
        },
        {
          "name": "system_program",
          "address": "11111111111111111111111111111111"
        }
      ],
      "args": [
        {
          "name": "amount",
          "type": "u64"
        }
      ]
    }
  ],
  "accounts": [
    {
      "name": "FeeTreasury",
      "discriminator": [
        85,
        11,
        82,
        13,
        148,
        202,
        81,
        5
      ]
    },
    {
      "name": "PendingOverride",
      "discriminator": [
        28,
        15,
        81,
        213,
        186,
        8,
        97,
        138
      ]
    },
    {
      "name": "VaultConfig",
      "discriminator": [
        99,
        86,
        43,
        216,
        184,
        102,
        119,
        77
      ]
    }
  ],
  "events": [
    {
      "name": "AgentSignerUpdated",
      "discriminator": [
        9,
        76,
        133,
        116,
        78,
        130,
        96,
        209
      ]
    },
    {
      "name": "FeeTreasuryInitialized",
      "discriminator": [
        150,
        203,
        243,
        115,
        122,
        73,
        80,
        224
      ]
    },
    {
      "name": "FeesWithdrawn",
      "discriminator": [
        234,
        15,
        0,
        119,
        148,
        241,
        40,
        21
      ]
    },
    {
      "name": "OverrideApproved",
      "discriminator": [
        173,
        131,
        53,
        85,
        191,
        81,
        150,
        221
      ]
    },
    {
      "name": "OverrideCreated",
      "discriminator": [
        109,
        39,
        191,
        207,
        28,
        235,
        116,
        67
      ]
    },
    {
      "name": "PolicyUpdated",
      "discriminator": [
        225,
        112,
        112,
        67,
        95,
        236,
        245,
        161
      ]
    },
    {
      "name": "TransactionBlocked",
      "discriminator": [
        3,
        64,
        83,
        53,
        179,
        19,
        131,
        87
      ]
    },
    {
      "name": "TransactionExecuted",
      "discriminator": [
        211,
        227,
        168,
        14,
        32,
        111,
        189,
        210
      ]
    },
    {
      "name": "VaultCreated",
      "discriminator": [
        117,
        25,
        120,
        254,
        75,
        236,
        78,
        115
      ]
    },
    {
      "name": "VaultInitialized",
      "discriminator": [
        180,
        43,
        207,
        2,
        18,
        71,
        3,
        75
      ]
    },
    {
      "name": "VaultPaused",
      "discriminator": [
        198,
        157,
        22,
        151,
        68,
        100,
        162,
        35
      ]
    },
    {
      "name": "VaultResumed",
      "discriminator": [
        208,
        173,
        238,
        64,
        33,
        63,
        226,
        151
      ]
    },
    {
      "name": "WhitelistUpdated",
      "discriminator": [
        205,
        110,
        205,
        193,
        238,
        237,
        220,
        22
      ]
    }
  ],
  "errors": [
    {
      "code": 12000,
      "name": "NotWhitelisted",
      "msg": "Destination address is not whitelisted"
    },
    {
      "code": 12001,
      "name": "DailyLimitExceeded",
      "msg": "Transaction amount exceeds daily limit"
    },
    {
      "code": 12002,
      "name": "VaultPaused",
      "msg": "Vault is paused"
    },
    {
      "code": 12003,
      "name": "UnauthorizedSigner",
      "msg": "Unauthorized signer"
    },
    {
      "code": 12004,
      "name": "OverrideExpired",
      "msg": "Override request has expired"
    },
    {
      "code": 12005,
      "name": "OverrideAlreadyExecuted",
      "msg": "Override has already been executed"
    },
    {
      "code": 12006,
      "name": "InvalidDailyLimit",
      "msg": "Invalid daily limit (must be greater than zero)"
    },
    {
      "code": 12007,
      "name": "InvalidTimestamp",
      "msg": "Invalid timestamp"
    },
    {
      "code": 12008,
      "name": "InsufficientFunds",
      "msg": "Insufficient funds in vault"
    },
    {
      "code": 12009,
      "name": "InvalidAmount",
      "msg": "Invalid amount (must be greater than zero)"
    },
    {
      "code": 12010,
      "name": "InvalidPolicy",
      "msg": "Invalid policy parameters"
    },
    {
      "code": 12011,
      "name": "ArithmeticOverflow",
      "msg": "Arithmetic overflow"
    },
    {
      "code": 12012,
      "name": "WhitelistFull",
      "msg": "Whitelist is full (maximum 20 addresses)"
    },
    {
      "code": 12013,
      "name": "WhitelistNotFound",
      "msg": "Whitelist address not found"
    },
    {
      "code": 12014,
      "name": "OverrideAlreadyExists",
      "msg": "Override already exists for this transaction"
    },
    {
      "code": 12015,
      "name": "InvalidAuthority",
      "msg": "Invalid vault authority"
    },
    {
      "code": 12016,
      "name": "InvalidAgentSigner",
      "msg": "Invalid agent signer - does not match vault.agent_signer"
    }
  ],
  "types": [
    {
      "name": "AgentSignerUpdated",
      "docs": [
        "Emitted when the agent signer is updated",
        "",
        "This event is emitted when the vault authority rotates the AI agent signer key."
      ],
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "vault",
            "docs": [
              "Public key of the vault"
            ],
            "type": "pubkey"
          },
          {
            "name": "old_signer",
            "docs": [
              "Old agent signer pubkey"
            ],
            "type": "pubkey"
          },
          {
            "name": "new_signer",
            "docs": [
              "New agent signer pubkey"
            ],
            "type": "pubkey"
          },
          {
            "name": "timestamp",
            "docs": [
              "Unix timestamp of update"
            ],
            "type": "i64"
          }
        ]
      }
    },
    {
      "name": "BlockReason",
      "docs": [
        "Reasons why a transaction can be blocked",
        "",
        "These reason codes are used in the TransactionBlocked event to indicate",
        "why a transaction was rejected by the vault's policy engine."
      ],
      "repr": {
        "kind": "rust"
      },
      "type": {
        "kind": "enum",
        "variants": [
          {
            "name": "NotWhitelisted"
          },
          {
            "name": "ExceededDailyLimit"
          },
          {
            "name": "InsufficientFunds"
          }
        ]
      }
    },
    {
      "name": "FeeTreasury",
      "docs": [
        "Fee treasury account for collecting protocol fees",
        "",
        "PDA seeds: [b\"treasury\"]",
        "",
        "This is a singleton account that collects all protocol fees.",
        "The authority (protocol owner) can withdraw fees periodically."
      ],
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "authority",
            "docs": [
              "Authority that can withdraw from the treasury (protocol owner)"
            ],
            "type": "pubkey"
          },
          {
            "name": "total_collected",
            "docs": [
              "Total fees collected lifetime (in lamports)"
            ],
            "type": "u64"
          },
          {
            "name": "bump",
            "docs": [
              "PDA bump seed for verification"
            ],
            "type": "u8"
          }
        ]
      }
    },
    {
      "name": "FeeTreasuryInitialized",
      "docs": [
        "Emitted when the fee treasury is initialized",
        "",
        "This event is emitted by the initialize_treasury instruction."
      ],
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "treasury",
            "docs": [
              "Public key of the fee treasury PDA"
            ],
            "type": "pubkey"
          },
          {
            "name": "authority",
            "docs": [
              "Public key of the treasury authority (protocol owner)"
            ],
            "type": "pubkey"
          },
          {
            "name": "timestamp",
            "docs": [
              "Unix timestamp of initialization"
            ],
            "type": "i64"
          }
        ]
      }
    },
    {
      "name": "FeesWithdrawn",
      "docs": [
        "Emitted when fees are withdrawn from the treasury",
        "",
        "This event is emitted when the protocol authority withdraws collected fees."
      ],
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "treasury",
            "docs": [
              "Public key of the fee treasury"
            ],
            "type": "pubkey"
          },
          {
            "name": "amount",
            "docs": [
              "Amount withdrawn in lamports"
            ],
            "type": "u64"
          },
          {
            "name": "recipient",
            "docs": [
              "Recipient of the withdrawn fees"
            ],
            "type": "pubkey"
          },
          {
            "name": "remaining_balance",
            "docs": [
              "Remaining balance in treasury after withdrawal"
            ],
            "type": "u64"
          },
          {
            "name": "timestamp",
            "docs": [
              "Unix timestamp of withdrawal"
            ],
            "type": "i64"
          }
        ]
      }
    },
    {
      "name": "OverrideApproved",
      "docs": [
        "Emitted when a vault authority approves a pending override",
        "",
        "This event confirms that a previously blocked transaction has been manually approved.",
        "Guardian backend uses this to update transaction status and notify relevant parties.",
        "The transaction signature is available in the transaction metadata."
      ],
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "vault",
            "docs": [
              "Public key of the vault"
            ],
            "type": "pubkey"
          },
          {
            "name": "nonce",
            "docs": [
              "Nonce of the override that was approved"
            ],
            "type": "u64"
          },
          {
            "name": "timestamp",
            "docs": [
              "Unix timestamp of approval"
            ],
            "type": "i64"
          }
        ]
      }
    },
    {
      "name": "OverrideCreated",
      "docs": [
        "Emitted when a pending override is created for a blocked transaction",
        "",
        "This event provides all details needed for the Guardian backend to generate",
        "an approval Blink and send notification to the vault authority."
      ],
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "vault",
            "docs": [
              "Public key of the vault"
            ],
            "type": "pubkey"
          },
          {
            "name": "nonce",
            "docs": [
              "Unique nonce for this override request"
            ],
            "type": "u64"
          },
          {
            "name": "amount",
            "docs": [
              "Amount of the blocked transaction"
            ],
            "type": "u64"
          },
          {
            "name": "destination",
            "docs": [
              "Destination address of the blocked transaction"
            ],
            "type": "pubkey"
          },
          {
            "name": "expires_at",
            "docs": [
              "Unix timestamp when this override expires (default: 1 hour)"
            ],
            "type": "i64"
          }
        ]
      }
    },
    {
      "name": "OverrideType",
      "docs": [
        "Override type indicating why the transaction was blocked"
      ],
      "type": {
        "kind": "enum",
        "variants": [
          {
            "name": "ExceededLimit"
          },
          {
            "name": "Emergency"
          }
        ]
      }
    },
    {
      "name": "PendingOverride",
      "docs": [
        "Pending override request for a blocked transaction",
        "",
        "PDA seeds: [b\"override\", vault.key().as_ref(), nonce.to_le_bytes().as_ref()]",
        "",
        "When a transaction is blocked by policy, a PendingOverride is created",
        "to allow the vault authority to approve or reject the transaction manually.",
        "This creates a Blink for user approval via the Guardian service."
      ],
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "vault",
            "docs": [
              "Vault this override belongs to"
            ],
            "type": "pubkey"
          },
          {
            "name": "nonce",
            "docs": [
              "Unique nonce for this override (from vault.override_nonce)"
            ],
            "type": "u64"
          },
          {
            "name": "instruction_hash",
            "docs": [
              "Hash of the blocked instruction for verification",
              "This ensures the approved override matches the original blocked transaction"
            ],
            "type": {
              "array": [
                "u8",
                32
              ]
            }
          },
          {
            "name": "requested_amount",
            "docs": [
              "Amount of the blocked transaction (in lamports)"
            ],
            "type": "u64"
          },
          {
            "name": "destination",
            "docs": [
              "Destination address of the blocked transaction"
            ],
            "type": "pubkey"
          },
          {
            "name": "expires_at",
            "docs": [
              "Unix timestamp when this override expires"
            ],
            "type": "i64"
          },
          {
            "name": "executed",
            "docs": [
              "Whether this override has been executed"
            ],
            "type": "bool"
          },
          {
            "name": "override_type",
            "docs": [
              "Type of override (exceeded limit or emergency)"
            ],
            "type": {
              "defined": {
                "name": "OverrideType"
              }
            }
          },
          {
            "name": "bump",
            "docs": [
              "PDA bump seed for verification"
            ],
            "type": "u8"
          }
        ]
      }
    },
    {
      "name": "PolicyUpdated",
      "docs": [
        "Emitted when vault policy is updated (daily limit or whitelist changes)",
        "",
        "This event is emitted for update_daily_limit, add_to_whitelist, and remove_from_whitelist."
      ],
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "vault",
            "docs": [
              "Public key of the vault"
            ],
            "type": "pubkey"
          },
          {
            "name": "daily_limit",
            "docs": [
              "Current daily spending limit in lamports"
            ],
            "type": "u64"
          },
          {
            "name": "whitelist_size",
            "docs": [
              "Current number of addresses in the whitelist"
            ],
            "type": "u8"
          }
        ]
      }
    },
    {
      "name": "TransactionBlocked",
      "docs": [
        "Emitted when a transaction is blocked by vault policy",
        "",
        "This event triggers the Guardian backend to create a Blink for manual approval.",
        "The override_nonce is used to create the approval URL."
      ],
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "vault",
            "docs": [
              "Public key of the vault that blocked the transaction"
            ],
            "type": "pubkey"
          },
          {
            "name": "reason",
            "docs": [
              "Reason code for why the transaction was blocked (see BlockReason enum)"
            ],
            "type": "u8"
          },
          {
            "name": "amount",
            "docs": [
              "Amount that was attempted to be transferred"
            ],
            "type": "u64"
          },
          {
            "name": "destination",
            "docs": [
              "Destination address that was blocked"
            ],
            "type": "pubkey"
          },
          {
            "name": "override_nonce",
            "docs": [
              "Optional override nonce for creating approval Blink (None if InsufficientFunds)"
            ],
            "type": {
              "option": "u64"
            }
          }
        ]
      }
    },
    {
      "name": "TransactionExecuted",
      "docs": [
        "Emitted when a guarded transaction is successfully executed",
        "",
        "This event is emitted after a transaction passes all policy checks and completes.",
        "Guardian backend uses this for transaction history and analytics."
      ],
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "vault",
            "docs": [
              "Public key of the vault that executed the transaction"
            ],
            "type": "pubkey"
          },
          {
            "name": "amount",
            "docs": [
              "Amount transferred in lamports (before fees)"
            ],
            "type": "u64"
          },
          {
            "name": "destination",
            "docs": [
              "Destination address that received the funds"
            ],
            "type": "pubkey"
          },
          {
            "name": "fee_collected",
            "docs": [
              "Protocol fee collected in lamports (0.05% = 5 basis points)"
            ],
            "type": "u64"
          },
          {
            "name": "new_balance",
            "docs": [
              "Vault balance after transaction and fee deduction"
            ],
            "type": "u64"
          },
          {
            "name": "spent_today",
            "docs": [
              "Cumulative amount spent today after this transaction"
            ],
            "type": "u64"
          }
        ]
      }
    },
    {
      "name": "VaultConfig",
      "docs": [
        "Main vault configuration account",
        "",
        "PDA seeds: [b\"vault\", authority.key().as_ref(), &nonce.to_le_bytes()]",
        "",
        "This account stores all configuration and state for a user's vault,",
        "including spending limits, whitelisted addresses, and policy settings."
      ],
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "authority",
            "docs": [
              "Authority that controls this vault (owner)"
            ],
            "type": "pubkey"
          },
          {
            "name": "agent_signer",
            "docs": [
              "AI agent signer that can propose transactions"
            ],
            "type": "pubkey"
          },
          {
            "name": "daily_limit",
            "docs": [
              "Maximum amount that can be spent per day (in lamports)"
            ],
            "type": "u64"
          },
          {
            "name": "spent_today",
            "docs": [
              "Amount spent in the current day period (in lamports)"
            ],
            "type": "u64"
          },
          {
            "name": "last_reset",
            "docs": [
              "Unix timestamp of when the current day period started"
            ],
            "type": "i64"
          },
          {
            "name": "whitelist",
            "docs": [
              "Fixed-size array of whitelisted destination addresses (max 20)"
            ],
            "type": {
              "array": [
                "pubkey",
                20
              ]
            }
          },
          {
            "name": "whitelist_count",
            "docs": [
              "Number of active addresses in the whitelist"
            ],
            "type": "u8"
          },
          {
            "name": "tier",
            "docs": [
              "Vault tier determining available features"
            ],
            "type": {
              "defined": {
                "name": "VaultTier"
              }
            }
          },
          {
            "name": "fee_basis_points",
            "docs": [
              "Protocol fee in basis points (e.g., 5 = 0.05%)"
            ],
            "type": "u16"
          },
          {
            "name": "name",
            "docs": [
              "Human-readable name for this vault (max 50 chars, UTF-8 bytes)"
            ],
            "type": {
              "array": [
                "u8",
                50
              ]
            }
          },
          {
            "name": "name_len",
            "docs": [
              "Actual length of the name in bytes"
            ],
            "type": "u8"
          },
          {
            "name": "paused",
            "docs": [
              "Whether the vault is paused (all transactions blocked)"
            ],
            "type": "bool"
          },
          {
            "name": "override_nonce",
            "docs": [
              "Nonce for generating unique override PDAs"
            ],
            "type": "u64"
          },
          {
            "name": "vault_nonce",
            "docs": [
              "Vault nonce (unique per user, allows multiple vaults)"
            ],
            "type": "u64"
          },
          {
            "name": "bump",
            "docs": [
              "PDA bump seed for verification"
            ],
            "type": "u8"
          }
        ]
      }
    },
    {
      "name": "VaultCreated",
      "docs": [
        "Emitted when a new vault is created and initialized",
        "",
        "This event is emitted by the initialize_vault instruction.",
        "Guardian backend uses this to create a new vault record in the database."
      ],
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "vault",
            "docs": [
              "Public key of the vault PDA"
            ],
            "type": "pubkey"
          },
          {
            "name": "authority",
            "docs": [
              "Public key of the vault authority (human owner)"
            ],
            "type": "pubkey"
          },
          {
            "name": "tier",
            "docs": [
              "Vault tier (0 = Basic, 1 = Pro, 2 = Enterprise)"
            ],
            "type": "u8"
          },
          {
            "name": "daily_limit",
            "docs": [
              "Daily spending limit in lamports"
            ],
            "type": "u64"
          }
        ]
      }
    },
    {
      "name": "VaultInitialized",
      "docs": [
        "Emitted when a vault is initialized (legacy event name for backward compatibility)",
        "",
        "This is an alias for VaultCreated to maintain compatibility with existing code."
      ],
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "vault",
            "docs": [
              "Public key of the vault PDA"
            ],
            "type": "pubkey"
          },
          {
            "name": "authority",
            "docs": [
              "Public key of the vault authority (human owner)"
            ],
            "type": "pubkey"
          },
          {
            "name": "daily_limit",
            "docs": [
              "Daily spending limit in lamports"
            ],
            "type": "u64"
          },
          {
            "name": "timestamp",
            "docs": [
              "Unix timestamp of initialization"
            ],
            "type": "i64"
          }
        ]
      }
    },
    {
      "name": "VaultPaused",
      "docs": [
        "Emitted when a vault is paused by the authority",
        "",
        "When paused, no transactions can be executed until the vault is resumed."
      ],
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "vault",
            "docs": [
              "Public key of the vault that was paused"
            ],
            "type": "pubkey"
          }
        ]
      }
    },
    {
      "name": "VaultResumed",
      "docs": [
        "Emitted when a paused vault is resumed by the authority",
        "",
        "Normal transaction execution is restored after resuming."
      ],
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "vault",
            "docs": [
              "Public key of the vault that was resumed"
            ],
            "type": "pubkey"
          }
        ]
      }
    },
    {
      "name": "VaultTier",
      "docs": [
        "Vault tier enum determining features and limits"
      ],
      "type": {
        "kind": "enum",
        "variants": [
          {
            "name": "Personal"
          },
          {
            "name": "Team"
          },
          {
            "name": "Enterprise"
          }
        ]
      }
    },
    {
      "name": "WhitelistUpdated",
      "docs": [
        "Emitted when whitelist is modified (legacy event for backward compatibility)",
        "",
        "This event is emitted when addresses are added or removed from the whitelist."
      ],
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "vault",
            "docs": [
              "Public key of the vault"
            ],
            "type": "pubkey"
          },
          {
            "name": "address",
            "docs": [
              "Address that was added or removed"
            ],
            "type": "pubkey"
          },
          {
            "name": "added",
            "docs": [
              "True if address was added, false if removed"
            ],
            "type": "bool"
          },
          {
            "name": "timestamp",
            "docs": [
              "Unix timestamp of the change"
            ],
            "type": "i64"
          }
        ]
      }
    }
  ]
}